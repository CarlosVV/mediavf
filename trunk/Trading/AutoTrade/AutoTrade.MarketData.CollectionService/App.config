<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  
  <configSections>
    <section name="log4net"
             type="log4net.Config.Log4NetConfigurationSectionHandler, log4net"/>
    <section name="unity"
             type="Microsoft.Practices.Unity.Configuration.UnityConfigurationSection, Microsoft.Practices.Unity.Configuration"/>
    <section name="modules"
             type="Microsoft.Practices.Prism.Modularity.ModulesConfigurationSection, Microsoft.Practices.Prism"/>
  </configSections>
  
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5" />
  </startup>
  
  <connectionStrings>
    <add name="MarketDataRepository" connectionString="metadata=res://*/Entities.MarketDataRepository.csdl|res://*/Entities.MarketDataRepository.ssdl|res://*/Entities.MarketDataRepository.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=EVAN-PC;initial catalog=AutoTrade.MarketData;integrated security=True;MultipleActiveResultSets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
  </connectionStrings>

  <log4net>
    <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
      
      <!--log4net file location-->
      <file type="log4net.Util.PatternString" value="Logs\" />
      <param name="AppendToFile" value="true" />
      <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
      <rollingStyle value="Composite"/>
      <datePattern value="'CollectionServiceLog_'ddd'.log'"/>
      <maxSizeRollBackups value="10"/>
      <maximumFileSize value="1GB"/>
      <staticLogFileName value="false" />
      <filter type="log4net.Filter.LevelRangeFilter">
        <acceptOnMatch value="true" />
        <levelMin value="DEBUG" />
        <levelMax value="FATAL" />
      </filter>

      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date|[T%thread]|%-5level%newline%message%newline%exception%newline" />
      </layout>
    </appender>

    <root>
      <level value="ALL" />
      <appender-ref ref="RollingFileAppender" />
    </root>
  </log4net>

  <unity xmlns="http://schemas.microsoft.com/practices/2010/unity">
    <typeAliases>
      <!-- Lifetime manager types -->
      <typeAlias alias="singleton"
                 type="Microsoft.Practices.Unity.ContainerControlledLifetimeManager, Microsoft.Practices.Unity"/>
      <typeAlias alias="perThread"
                 type="Microsoft.Practices.Unity.PerThreadLifetimeManager, Microsoft.Practices.Unity"/>
      <typeAlias alias="external"
                 type="Microsoft.Practices.Unity.ExternallyControlledLifetimeManager, Microsoft.Practices.Unity"/>
      <typeAlias alias="instance"
                 type="Microsoft.Practices.Unity.TransientLifetimeManager, Microsoft.Practices.Unity"/>
    </typeAliases>
    <container>
      <type type="Microsoft.Practices.Prism.Logging.ILoggerFacade, Microsoft.Practices.Prism"
            mapTo="AutoTrade.Core.Logging.Log4NetWrapper, AutoTrade.Core">
        <lifetime type="singleton" />
      </type>
      <type type="Microsoft.Practices.Prism.Modularity.IModuleCatalog, Microsoft.Practices.Prism"
            mapTo="AutoTrade.Core.Modularity.RepositoryModuleCatalog, AutoTrade.Core">
        <lifetime type="singleton"/>
      </type>
      <type type="AutoTrade.Core.Settings.ISettingsProvider, AutoTrade.Core"
            mapTo="AutoTrade.Core.Settings.AppSettingsProvider, AutoTrade.Core">
        <lifetime type="singleton"/>
      </type>
      <type type="AutoTrade.Core.Web.IWebRequestExecutor, AutoTrade.Core"
            mapTo="AutoTrade.Core.Web.WebRequestExecutor, AutoTrade.Core">
        <lifetime type="instance"/>
      </type>
      <type type="AutoTrade.Core.Modularity.Configuration.IAssemblyConfigurationFactory, AutoTrade.Core"
            mapTo="AutoTrade.Core.Modularity.Configuration.AssemblyConfigurationFactory, AutoTrade.Core">
        <lifetime type="singleton"/>
      </type>
      <type type="AutoTrade.Core.Modularity.Configuration.IAssemblyConfigurationManager, AutoTrade.Core"
            mapTo="AutoTrade.Core.Modularity.Configuration.AssemblyConfigurationManager, AutoTrade.Core">
        <lifetime type="singleton"/>
      </type>
      <type type="AutoTrade.MarketData.ISubscriptionFactory, AutoTrade.MarketData"
            mapTo="AutoTrade.MarketData.SubscriptionFactory, AutoTrade.MarketData">
        <lifetime type="singleton"/>
      </type>
      <type type="AutoTrade.Core.Modularity.IModuleDataRepository, AutoTrade.Core"
            mapTo="AutoTrade.MarketData.Entities.MarketDataRepository, AutoTrade.MarketData">
        <lifetime type="singleton"/>
      </type>
      <type type="AutoTrade.MarketData.Entities.IMarketDataRepository, AutoTrade.MarketData"
            mapTo="AutoTrade.MarketData.Entities.MarketDataRepository, AutoTrade.MarketData">
        <lifetime type="instance"/>
      </type>
      <type type="AutoTrade.MarketData.ISubscriptionManager, AutoTrade.MarketData"
            mapTo="AutoTrade.MarketData.SubscriptionManager, AutoTrade.MarketData">
        <lifetime type="singleton"/>
      </type>
      <type type="System.Collections.Generic.IEnumerable`1[[AutoTrade.MarketData.IMarketDataProvider, AutoTrade.MarketData]], mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
            mapTo="AutoTrade.MarketData.IMarketDataProvider[], AutoTrade.MarketData">
        <lifetime type="singleton"/>
      </type>
      <type name="StaticStockListProvider"
            type="AutoTrade.MarketData.IStockListProvider, AutoTrade.MarketData"
            mapTo="AutoTrade.MarketData.StaticStockListProvider, AutoTrade.MarketData">
        <lifetime type="instance"/>
      </type>
      <type type="System.Collections.Generic.IEnumerable`1[[AutoTrade.MarketData.IStockListProvider, AutoTrade.MarketData]], mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
            mapTo="AutoTrade.MarketData.IStockListProvider[], AutoTrade.MarketData">
        <lifetime type="singleton"/>
      </type>
      <type type="AutoTrade.MarketData.ISubscriptionFactory, AutoTrade.MarketData"
            mapTo="AutoTrade.MarketData.SubscriptionFactory, AutoTrade.MarketData">
        <lifetime type="singleton"/>
      </type>
    </container>
  </unity>
  
</configuration>